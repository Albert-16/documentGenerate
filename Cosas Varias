using System;
using System.Collections.Generic;
using System.IO;

public static class MimeTypeHelper
{
    private static readonly Dictionary<string, string> _mimeTypes = new()
    {
        { ".pdf", "application/pdf" },
        { ".jpg", "image/jpeg" },
        { ".jpeg", "image/jpeg" },
        { ".png", "image/png" },
        { ".gif", "image/gif" },
        { ".txt", "text/plain" },
        { ".csv", "text/csv" },
        { ".doc", "application/msword" },
        { ".docx", "application/vnd.openxmlformats-officedocument.wordprocessingml.document" },
        { ".xls", "application/vnd.ms-excel" },
        { ".xlsx", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" }
        // Agrega las extensiones que uses frecuentemente
    };

    public static string GetContentType(string fileName, string fallback = "application/octet-stream")
    {
        if (string.IsNullOrWhiteSpace(fileName))
            return fallback;

        string ext = Path.GetExtension(fileName).ToLowerInvariant();
        if (_mimeTypes.TryGetValue(ext, out string mime))
        {
            return mime;
        }

        return fallback; // Si no encuentra la extensi√≥n, usa el valor por defecto
    }
}
