using MigraDoc.DocumentObjectModel;
using MigraDoc.DocumentObjectModel.Tables;

public void AgregarModuloBeneficiarios(
    Section sec,
    List<(string Beneficiario, string Parentesco, string Identidad)> filas)
{
    var table = sec.AddTable();
    table.Format.Font.Name = "Arial";
    table.Format.Font.Size = 9;
    table.Borders.Width = 0;

    // A4 con márgenes 1 cm ≈ 17 cm de ancho util
    table.AddColumn("8cm");  // Beneficiario
    table.AddColumn("4cm");  // Parentesco
    table.AddColumn("5cm");  // Identidad

    // Encabezado
    var header = table.AddRow();
    header.Format.Font.Bold = true;
    header.Shading.Color = Colors.WhiteSmoke;
    header.Cells[0].AddParagraph("Beneficiario");
    header.Cells[1].AddParagraph("Parentesco");
    header.Cells[2].AddParagraph("Identidad");

    // Filas
    foreach (var f in filas)
    {
        var row = table.AddRow();
        row.KeepTogether = true;             // ayuda a evitar cortes feos
        row.BottomPadding = Unit.FromPoint(1);
        row.Cells[0].AddParagraph(f.Beneficiario ?? string.Empty);
        row.Cells[1].AddParagraph(f.Parentesco ?? string.Empty);
        row.Cells[2].AddParagraph(f.Identidad ?? string.Empty);
    }

    // Si usas separador visual:
    // PdfSeparadoresHelper.AddLinea(sec, grosorPt: 0.75, espacioArribaPt: 4, espacioAbajoPt: 4);
}
