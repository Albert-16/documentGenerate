using MigraDoc.DocumentObjectModel;
using MigraDoc.DocumentObjectModel.Tables;

public static class PdfSeparadoresHelper
{
    public static void AddLinea(
        Section sec,
        double grosorPt = 0.75,
        double espacioArribaPt = 4,
        double espacioAbajoPt = 4)
    {
        var contentWidth = sec.PageSetup.PageWidth
                          - sec.PageSetup.LeftMargin
                          - sec.PageSetup.RightMargin;

        var table = sec.AddTable();
        table.Borders.Width = 0;
        table.LeftPadding = 0;
        table.RightPadding = 0;
        table.TopPadding = 0;
        table.BottomPadding = 0;
        table.Format.SpaceBefore = 0;
        table.Format.SpaceAfter  = 0;

        table.AddColumn(contentWidth);

        var row = table.AddRow();

        // línea
        row.Borders.Bottom.Width = grosorPt;
        row.Borders.Bottom.Color = Colors.Gray;

        // alto mínimo = grosor; NO Exactly para que respete padding
        row.HeightRule = RowHeightRule.AtLeast;
        row.Height = Unit.FromPoint(grosorPt);

        // aire simétrico SIN párrafos
        row.TopPadding = Unit.FromPoint(espacioArribaPt);
        row.BottomPadding = Unit.FromPoint(espacioAbajoPt);
        row.Format.SpaceBefore = 0;
        row.Format.SpaceAfter  = 0;
    }
}
