using MigraDoc.DocumentObjectModel;
using MigraDoc.DocumentObjectModel.Tables;

public static void AgregarBloqueFirmasDoble(
    Section section,
    string rutaImagenFirmaBanco,
    double separacionCm = 1.0,
    double altoFilaContenidoCm = 1.8,
    double anchoImagenCm = 4.5,
    double anchoBloqueTotalCm = 0 // 0 = usar todo el ancho útil (página - márgenes)
)
{
    if (section == null) throw new ArgumentNullException(nameof(section));

    // Ancho útil de la página
    Unit anchoUtilPagina = section.PageSetup.PageWidth - section.PageSetup.LeftMargin - section.PageSetup.RightMargin;

    // Ancho del bloque (puede ser menor al útil para que no ocupe todo el ancho)
    Unit anchoBloque = anchoBloqueTotalCm > 0
        ? Unit.FromCentimeter(anchoBloqueTotalCm)
        : anchoUtilPagina;

    // Columnas: [Firma IZQ][Espaciador][Firma DER]
    Unit colEspaciadora = Unit.FromCentimeter(separacionCm);
    if (colEspaciadora > anchoBloque) colEspaciadora = anchoBloque / 10; // salvaguarda
    Unit colFirma = (anchoBloque - colEspaciadora) / 2;

    // Tabla
    var tabla = section.AddTable();
    tabla.Borders.Width = 0;
    tabla.TopPadding = 0;
    tabla.BottomPadding = 0;
    tabla.LeftPadding = 0;
    tabla.RightPadding = 0;
    tabla.Format.SpaceBefore = Unit.FromCentimeter(0.4);
    tabla.Format.SpaceAfter = Unit.FromCentimeter(0.4);
    tabla.Format.Alignment = ParagraphAlignment.Center; // centra contenido de párrafos

    tabla.AddColumn(colFirma);
    tabla.AddColumn(colEspaciadora);
    tabla.AddColumn(colFirma);

    // Centrar la tabla dentro del ancho útil
    tabla.Rows.LeftIndent = (anchoUtilPagina - anchoBloque) / 2;

    // ---------- Fila 1: contenido sobre la línea
