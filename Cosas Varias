public async Task ActualizarEstadoEnvioBatchAsync(IEnumerable<(string IdDocumento, int Estado)> items)
{
    const string sql = @"
UPDATE EVERTECDTA.GCTDC09L1
   SET GCTDC09014 = ?,
       GCTDC09007 = ?,
       GCTDC09008 = ?
 WHERE GCTDC09001 = ?";

    // Si tu conexión es OleDb (AS400), es mejor con '?' por orden (posicional)
    // Dapper con OleDb usa parámetros posicionales.

    if (_connection.State != ConnectionState.Open)
        _connection.Open();

    using var tx = _connection.BeginTransaction();

    try
    {
        var now = DateTime.Now;
        var fecha = now.ToString("yyyyMMdd");
        var hora  = now.ToString("HHmmss");

        foreach (var it in items)
        {
            await _connection.ExecuteAsync(
                sql,
                new object[] { it.Estado, fecha, hora, it.IdDocumento },
                tx);
        }

        tx.Commit();
    }
    catch
    {
        tx.Rollback();
        throw;
    }
}
