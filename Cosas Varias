using AsmxServiceReference;

namespace AsmxServiceSdk;

public interface IEmailSenderClient
{
    Task<AddTextResponse> AddTextAsync(string guidCode, string shippingDate, string subject, string textBody, CancellationToken ct = default);

    Task<CreateMailResponse> CreateMailAsync(string origin, string system, string template, string language, string to, string from, string subject, string body, CancellationToken ct = default);
}

public sealed class EmailSenderClient : IEmailSenderClient
{
    private readonly WSDL_BAN_MS_12_EmailSenderSoapClient _client;

    public EmailSenderClient(HttpClient httpClient)
    {
        // el proxy generado tiene un ctor que recibe HttpClient
        _client = new WSDL_BAN_MS_12_EmailSenderSoapClient(httpClient);
    }

    public Task<AddTextResponse> AddTextAsync(string guidCode, string shippingDate, string subject, string textBody, CancellationToken ct = default)
        => _client.AddTextAsync(guidCode, shippingDate, subject, textBody);

    public Task<CreateMailResponse> CreateMailAsync(string origin, string system, string template, string language, string to, string from, string subject, string body, CancellationToken ct = default)
        => _client.CreateMailAsync(origin, system, template, language, to, from, subject, body);
}
