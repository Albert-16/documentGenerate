using System;
using System.Text;

static string DecodeBase64Safe(string input)
{
    if (string.IsNullOrWhiteSpace(input)) return "";

    // limpia espacios/saltos de línea
    var s = input.Trim().Replace("\r", "").Replace("\n", "").Replace(" ", "");

    // corrige padding si falta
    int mod = s.Length % 4;
    if (mod != 0) s = s.PadRight(s.Length + (4 - mod), '=');

    try
    {
        var bytes = Convert.FromBase64String(s);
        return Encoding.UTF8.GetString(bytes);
    }
    catch
    {
        // si no era base64 válido, devuelve el original (o lanza error si prefieres)
        return input;
    }
}

// Uso:
DavMail.Params = DecodeBase64Safe(dato.GetValue("EML11PARM"));
