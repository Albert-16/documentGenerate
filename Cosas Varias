using MigraDoc.DocumentObjectModel;
using MigraDoc.Rendering;
using HtmlAgilityPack;
using System.IO;

public static class HtmlToPdfHelper
{
    public static void ConvertHtmlToPdf(string htmlContent, string outputPdfPath)
    {
        var htmlDoc = new HtmlDocument();
        htmlDoc.LoadHtml(htmlContent);

        var document = new Document();
        var section = document.AddSection();
        section.PageSetup.TopMargin = Unit.FromCentimeter(2);
        section.PageSetup.BottomMargin = Unit.FromCentimeter(2);
        section.PageSetup.LeftMargin = Unit.FromCentimeter(2);
        section.PageSetup.RightMargin = Unit.FromCentimeter(2);

        foreach (var node in htmlDoc.DocumentNode.SelectNodes("//p | //h1 | //h2 | //h3 | //table"))
        {
            if (node.Name == "p")
            {
                var paragraph = section.AddParagraph(node.InnerText);
                paragraph.Format.SpaceAfter = "4pt";
            }
            else if (node.Name.StartsWith("h"))
            {
                var paragraph = section.AddParagraph(node.InnerText);
                paragraph.Format.Font.Bold = true;
                paragraph.Format.SpaceAfter = "6pt";
            }
            // puedes expandir aqu√≠ soporte para <table>, <b>, <i>, etc.
        }

        var pdfRenderer = new PdfDocumentRenderer(true)
        {
            Document = document
        };
        pdfRenderer.RenderDocument();
        pdfRenderer.Save(outputPdfPath);
    }
}
