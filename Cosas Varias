
// using MigraDoc.DocumentObjectModel;

private void AgregarBloqueCifFecha(
    Section sec,
    string cif,
    DateTime fechaHora,
    ParagraphAlignment alineacion = ParagraphAlignment.Right,
    string etiquetaCif = "N° de CIF:",
    string etiquetaFecha = "Fecha y hora:",
    string spaceAfter = "0.4cm")
{
    var p = sec.AddParagraph();
    p.Format.Alignment = alineacion;
    p.Format.SpaceAfter = spaceAfter;
    p.Format.Font.Size = 11;

    p.AddFormattedText(etiquetaCif + " ", TextFormat.Bold);
    p.AddText(string.IsNullOrWhiteSpace(cif) ? "—" : cif);
    p.AddLineBreak();
    p.AddFormattedText(etiquetaFecha + " ", TextFormat.Bold);
    p.AddText(fechaHora.ToString("dd/MM/yyyy HH:mm"));
}




// using MigraDoc.DocumentObjectModel;

// using MigraDoc.DocumentObjectModel;
// using MigraDoc.DocumentObjectModel.Tables;
// using MigraDoc.DocumentObjectModel.Shapes;

private void AgregarBloqueFirmasDosColumnas(
    Section sec,
    string etiquetaBanco = "El Banco",
    string textoFirmaClienteArriba = "Aceptado Digitalmente",
    string etiquetaClienteAbajo = "El Cliente",
    string rutaFirmaBanco = null,            // opcional: imagen de firma del banco
    string rutaFirmaCliente = null,          // opcional: imagen (si la tuvieras)
    double anchoFirmaCm = 2.5,
    string espacioAntes = "0.4cm",
    string espacioDespues = "0.4cm")
{
    // Espacio antes
    if (!string.IsNullOrEmpty(espacioAntes))
        sec.AddParagraph().Format.SpaceBefore = espacioAntes;

    var t = sec.AddTable();
    t.Borders.Width = 0; // sin bordes
    t.AddColumn(Unit.FromCentimeter(8.0)); // Banco
    t.AddColumn(Unit.FromCentimeter(8.0)); // Cliente

    var row = t.AddRow();
    row.TopPadding = "0.2cm";
    row.BottomPadding = "0.2cm";
    row.VerticalAlignment = VerticalAlignment.Top;

    // ===== Columna Banco =====
    // (1) firma imagen (opcional)
    if (!string.IsNullOrWhiteSpace(rutaFirmaBanco))
    {
        var imgB = row.Cells[0].AddImage(rutaFirmaBanco);
        imgB.LockAspectRatio = true;
        imgB.Width = Unit.FromCentimeter(anchoFirmaCm);
        imgB.Top = ShapePosition.Top;
        imgB.Left = ShapePosition.Center;
    }

    // (2) línea de firma
    var pLineaBanco = row.Cells[0].AddParagraph();
    pLineaBanco.Format.SpaceBefore = "1.0cm";
    pLineaBanco.Format.Borders.Bottom.Width = 0.5;
    pLineaBanco.Format.Borders.Bottom.Color = Colors.Gray;
    pLineaBanco.Format.SpaceAfter = "0.15cm";

    // (3) etiqueta bajo la línea
    var pBanco = row.Cells[0].AddParagraph(etiquetaBanco);
    pBanco.Format.Alignment = ParagraphAlignment.Center;
    pBanco.Format.Font.Size = 11;

    // ===== Columna Cliente =====
    // (1) texto “firma” ARRIBA
    var pArriba = row.Cells[1].AddParagraph(textoFirmaClienteArriba);
    pArriba.Format.Alignment = ParagraphAlignment.Center;
    pArriba.Format.Font.Size = 11;

    // (2) firma imagen (opcional)
    if (!string.IsNullOrWhiteSpace(rutaFirmaCliente))
    {
        var imgC = row.Cells[1].AddImage(rutaFirmaCliente);
        imgC.LockAspectRatio = true;
        imgC.Width = Unit.FromCentimeter(anchoFirmaCm);
        imgC.Top = ShapePosition.Top;
        imgC.Left = ShapePosition.Center;
    }

    // (3) línea debajo del texto/imagen
    var pLineaCli = row.Cells[1].AddParagraph();
    pLineaCli.Format.SpaceBefore = "0.25cm";
    pLineaCli.Format.Borders.Bottom.Width = 0.5;
    pLineaCli.Format.Borders.Bottom.Color = Colors.Gray;
    pLineaCli.Format.SpaceAfter = "0.15cm";

    // (4) etiqueta bajo la línea (El Cliente)
    var pCliente = row.Cells[1].AddParagraph(etiquetaClienteAbajo);
    pCliente.Format.Alignment = ParagraphAlignment.Center;
    pCliente.Format.Font.Size = 11;

    // Espacio después
    if (!string.IsNullOrEmpty(espacioDespues))
        sec.AddParagraph().Format.SpaceBefore = espacioDespues;
}
